import{e as d,o as c,a as t,h as C,F as I,i as j,n as F,f as y,t as _,d as V,u as A,b as T,j as g,v as b,g as o,k as D,l as L}from"./app-BkiIwDrh.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const N={class:"space-y-4"},R={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},z={class:"relative bg-[#0f0f0f] border-2 border-dashed border-[#2a2a2a] rounded-lg overflow-hidden hover:border-[#ffa236]/50 transition-all aspect-square"},B=["src","alt"],M={key:1,class:"w-full h-full flex flex-col items-center justify-center text-gray-500 group-hover:text-[#ffa236] transition-colors"},O={class:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2"},q=["onClick"],P={class:"bg-[#ffa236] hover:bg-[#ffb54d] text-black rounded-full w-10 h-10 flex items-center justify-center cursor-pointer transition-colors"},G=["name","onChange"],X={class:"mt-2"},Y={class:"text-gray-300 text-sm font-medium block"},H={class:"text-gray-500 text-xs mt-1"},J={__name:"ImageGrid",props:{images:{type:Object,default:()=>({banner_home:{url:null,id:null},banner_artist:{url:null,id:null},carousel_home:{url:null,id:null},carousel_discography:{url:null,id:null}})},fileInputs:{type:Object,default:()=>({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null})}},emits:["delete-image","file-selected"],setup(h,{emit:l}){const f=h,k=l,s={banner_home:{label:"Banner Principal (Home)",icon:"fa-image"},banner_artist:{label:"Banner del Artista",icon:"fa-image"},carousel_home:{label:"Imagen Carrusel Home",icon:"fa-images"},carousel_discography:{label:"Imagen Carrusel Discograf√≠a",icon:"fa-images"}},w=p=>{confirm("¬øEliminar esta imagen? Se eliminar√° de ImageKit.")&&k("delete-image",p)},v=(p,m)=>{const i=m.target.files[0];i&&(k("file-selected",{fieldKey:p,file:i}),console.log(`üìÅ Archivo seleccionado para ${p}:`,i.name))},S=p=>{var m,i;return((m=f.fileInputs[`${p}_file`])==null?void 0:m.preview)||((i=f.images[p])==null?void 0:i.url)};return(p,m)=>(c(),d("div",N,[m[3]||(m[3]=t("h3",{class:"text-[#ffa236] font-semibold flex items-center gap-2"},[t("i",{class:"fa-solid fa-images"}),C("Im√°genes ")],-1)),t("div",R,[(c(!0),d(I,null,j(Object.keys(s),i=>{var n,e;return c(),d("div",{key:i,class:"group relative"},[t("div",z,[S(i)?(c(),d("img",{key:0,src:S(i),alt:s[i].label,class:"w-full h-full object-cover"},null,8,B)):(c(),d("div",M,[t("i",{class:F(`fa-solid ${s[i].icon} text-3xl mb-2`)},null,2),m[0]||(m[0]=t("span",{class:"text-xs text-center"},"Sin imagen",-1))])),t("div",O,[(n=f.images[i])!=null&&n.url?(c(),d("button",{key:0,onClick:r=>w(i),type:"button",class:"bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center transition-colors",title:"Eliminar imagen"},[...m[1]||(m[1]=[t("i",{class:"fa-solid fa-trash text-sm"},null,-1)])],8,q)):y("",!0),t("label",P,[m[2]||(m[2]=t("i",{class:"fa-solid fa-plus text-sm"},null,-1)),t("input",{type:"file",name:`${i}_file`,accept:"image/*",class:"hidden",onChange:r=>v(i,r)},null,40,G)])])]),t("div",X,[t("label",Y,_(s[i].label),1),t("p",H,_((e=f.images[i])!=null&&e.url?"‚úÖ Subida":"‚≠ï Vac√≠a"),1)])])}),128))]),m[4]||(m[4]=t("div",{class:"bg-[#0f0f0f] border border-[#2a2a2a] rounded-lg p-3 text-sm text-gray-400"},[t("p",{class:"flex items-start gap-2"},[t("i",{class:"fa-solid fa-circle-info text-[#ffa236] mt-0.5 flex-shrink-0"}),t("span",null,"Todos los cambios en im√°genes se sincronizan autom√°ticamente al guardar el artista.")])],-1))]))}},W=E(J,[["__scopeId","data-v-ee177a42"]]),Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Z={key:0,class:"text-red-500 text-sm mt-1"},K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ee={key:0,class:"text-red-500 text-sm mt-1"},te={key:0,class:"text-red-500 text-sm mt-1"},se={key:1,class:"text-xs text-gray-500 mt-1"},le=["value"],ae={key:0,class:"mt-4"},oe={class:"w-full aspect-video rounded-lg overflow-hidden bg-black/50 border border-[#2a2a2a]"},re=["src"],ie=["src"],ne={key:2,class:"text-gray-400 p-4"},ue={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},de={class:"text-gray-300 text-sm"},ce=["onUpdate:modelValue"],me={class:"flex justify-end"},pe={type:"submit",class:"btn-primary"},fe={__name:"Form",props:{artist:{type:Object,default:()=>({})},genres:{type:Array,default:()=>[]},mode:{type:String,default:"create"}},setup(h){var i;const l=h,f=V(!1),k=()=>{const n={spotify:"",youtube:"",instagram:"",tiktok:"",facebook:"",x:"",apple:"",amazon:""};if(l.artist.social_links_formatted&&typeof l.artist.social_links_formatted=="object")return{...n,...l.artist.social_links_formatted};if(!l.artist.social_links)return n;if(typeof l.artist.social_links=="object"&&!Array.isArray(l.artist.social_links))return{...n,...l.artist.social_links};if(Array.isArray(l.artist.social_links)){const e={...n};return l.artist.social_links.forEach(r=>{if(r.platform&&r.url){const u=r.platform.toLowerCase();e[u]=r.url}}),e}return n},s=A({name:l.artist.name||"",bio:l.artist.bio||"",country:l.artist.country||"",genre_id:l.artist.genre_id||"",social_links:k(),presentation_video_url:l.artist.presentation_video_url||"",email:((i=l.artist.user)==null?void 0:i.email)||"",password:"",banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),w=V({banner_home:{url:l.artist.banner_home_url||null,id:l.artist.banner_home_id||null},banner_artist:{url:l.artist.banner_artist_url||null,id:l.artist.banner_artist_id||null},carousel_home:{url:l.artist.carousel_home_url||null,id:l.artist.carousel_home_id||null},carousel_discography:{url:l.artist.carousel_discography_url||null,id:l.artist.carousel_discography_id||null}}),v=V({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),S=({fieldKey:n,file:e})=>{const r=`${n}_file`;s[r]=e;const u=new FileReader;u.onload=a=>{v.value[r]={preview:a.target.result}},u.readAsDataURL(e),console.log(`‚úÖ Archivo ${r} seleccionado:`,e.name)},p=async n=>{var e,r;if(!f.value){if(!((e=l.artist)!=null&&e.id)){alert("No se encontr√≥ el artista.");return}f.value=!0;try{const u=await fetch(route("admin.artists.deleteImage",l.artist.id),{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRF-TOKEN":(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.content},body:JSON.stringify({field:n})});if(console.log("üîé Status delete:",u.status),!u.ok){const U=await u.text();console.error("‚ùå Respuesta del servidor:",U),alert("No se pudo eliminar la imagen");return}const a=await u.json();console.log("‚úÖ Imagen eliminada correctamente",a);const x=`${n}_url`,$=`${n}_id`;w.value[n]={url:a.artist[x],id:a.artist[$]},v.value[`${n}_file`]=null}catch(u){console.error("Error:",u),alert("Error al eliminar la imagen")}finally{f.value=!1}}},m=()=>{console.log("üü° Enviando formulario..."),console.log("üì¶ Datos actuales del form:",s.data());const n="post",e=l.mode==="edit"?route("admin.artists.update",l.artist.id):route("admin.artists.store");s.transform(r=>{var u;return{...r,_method:l.mode==="edit"?"put":"post",_token:(u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.content,social_links:r.social_links}}).submit(n,e,{forceFormData:!0,onStart:()=>console.log("üöÄ Enviando request a:",e),onProgress:r=>console.log("üì§ Subiendo...",r),onError:r=>{console.group("‚ùå Errores de validaci√≥n");for(const[u,a]of Object.entries(r))console.log(`- ${u}:`,a);console.groupEnd()},onSuccess:()=>console.log("‚úÖ Artista creado/actualizado correctamente"),onFinish:()=>console.log("üèÅ Proceso finalizado")})};return(n,e)=>{var r,u;return c(),d("form",{onSubmit:L(m,["prevent"]),class:"space-y-6"},[t("div",Q,[t("div",null,[e[7]||(e[7]=t("label",{class:"text-gray-300 text-sm"},"Nombre del artista",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o(s).name=a),type:"text",class:"input",placeholder:"Nombre art√≠stico"},null,512),[[b,o(s).name]]),o(s).errors.name?(c(),d("p",Z,_(o(s).errors.name),1)):y("",!0)]),t("div",K,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-gray-300 text-sm"},"Correo del artista",-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o(s).email=a),type:"email",class:"input",placeholder:"artista@email.com"},null,512),[[b,o(s).email]]),o(s).errors.email?(c(),d("p",ee,_(o(s).errors.email),1)):y("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"text-gray-300 text-sm"},"Contrase√±a",-1)),g(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o(s).password=a),type:"password",class:"input",placeholder:"Minimo 8 caracteres"},null,512),[[b,o(s).password]]),o(s).errors.password?(c(),d("p",te,_(o(s).errors.password),1)):y("",!0),l.mode==="edit"?(c(),d("p",se," Deja en blanco para no cambiarla. ")):y("",!0)])]),t("div",null,[e[10]||(e[10]=t("label",{class:"text-gray-300 text-sm"},"Pa√≠s",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o(s).country=a),type:"text",class:"input",placeholder:"Ej: Colombia"},null,512),[[b,o(s).country]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-gray-300 text-sm"},"G√©nero musical",-1)),g(t("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>o(s).genre_id=a),class:"input"},[e[11]||(e[11]=t("option",{disabled:"",value:""},"Selecciona un g√©nero",-1)),(c(!0),d(I,null,j(h.genres,a=>(c(),d("option",{key:a.id,value:a.id},_(a.name),9,le))),128))],512),[[D,o(s).genre_id]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"text-gray-300 text-sm"},"Biograf√≠a",-1)),g(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=a=>o(s).bio=a),rows:"4",class:"input",placeholder:"Breve descripci√≥n del artista..."},null,512),[[b,o(s).bio]])]),T(W,{images:w.value,"file-inputs":v.value,onFileSelected:S,onDeleteImage:p},null,8,["images","file-inputs"]),t("div",null,[e[15]||(e[15]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Video de Presentaci√≥n ",-1)),e[16]||(e[16]=t("label",{class:"text-gray-300 text-sm"},"URL del Video (YouTube/Vimeo)",-1)),g(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>o(s).presentation_video_url=a),type:"url",class:"input",placeholder:"https://www.youtube.com/watch?v=... o https://vimeo.com/..."},null,512),[[b,o(s).presentation_video_url]]),e[17]||(e[17]=t("p",{class:"text-gray-500 text-xs mt-2"}," Soporta YouTube y Vimeo. Se mostrar√° en el perfil p√∫blico del artista. ",-1)),o(s).presentation_video_url?(c(),d("div",ae,[e[14]||(e[14]=t("p",{class:"text-gray-300 text-sm mb-2"},"Vista previa:",-1)),t("div",oe,[o(s).presentation_video_url.includes("youtube")?(c(),d("iframe",{key:0,src:`https://www.youtube.com/embed/${(r=o(s).presentation_video_url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/))==null?void 0:r[1]}`,class:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,re)):o(s).presentation_video_url.includes("vimeo")?(c(),d("iframe",{key:1,src:`https://player.vimeo.com/video/${(u=o(s).presentation_video_url.match(/vimeo\.com\/(\d+)/))==null?void 0:u[1]}`,class:"w-full h-full",allow:"autoplay; fullscreen",allowfullscreen:""},null,8,ie)):(c(),d("p",ne," URL no v√°lida. Usa YouTube o Vimeo. "))])])):y("",!0)]),t("div",null,[e[18]||(e[18]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Redes sociales / Streaming ",-1)),t("div",ue,[(c(),d(I,null,j({spotify:"Spotify",youtube:"YouTube",instagram:"Instagram",tiktok:"TikTok",facebook:"Facebook",x:"X / Twitter",apple:"Apple Music",amazon:"Amazon Music"},(a,x)=>t("div",{key:x},[t("label",de,_(a),1),g(t("input",{"onUpdate:modelValue":$=>o(s).social_links[x]=$,type:"url",class:"input",placeholder:"https://..."},null,8,ce),[[b,o(s).social_links[x]]])])),64))]),e[19]||(e[19]=t("p",{class:"text-gray-500 text-xs mt-2"}," Solo se guardar√°n las redes con una URL v√°lida. ",-1))]),t("div",me,[t("button",pe,_(l.mode==="edit"?"Actualizar artista":"Guardar artista"),1)])],32)}}},ye=E(fe,[["__scopeId","data-v-688f74e1"]]);export{ye as default};
