import{d as h,y as I,x as D,c as F,w as S,a as e,e as l,f as d,j as N,o as n,F as T,i as C,t as a,k as L,v as V,g as U,m as A,h as M,n as W,b as Y,l as q,A as J}from"./app-UEwjYTSG.js";import{A as K}from"./AdminLayout-CNeqSKlj.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */import"./responsive-blanco-DOkwJ8BK.js";const X={class:"flex justify-between items-center mb-6"},Z={class:"flex flex-wrap items-center gap-4"},tt={class:"flex items-center gap-3"},et=["value"],st={class:"flex items-center gap-3"},ot={key:0,class:"flex items-center gap-2"},at={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 mb-6"},nt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},lt={class:"text-xl font-semibold text-white"},rt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},dt={class:"text-xl font-semibold text-emerald-300"},it={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},ut={class:"text-xl font-semibold text-gray-100"},ct={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},pt={class:"text-xl font-semibold text-green-300"},xt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},ft={class:"text-xl font-semibold text-yellow-300"},_t={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},mt={class:"text-xl font-semibold text-white"},gt={key:1,class:"grid grid-cols-1 sm:grid-cols-5 gap-4 mb-6"},bt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},vt={class:"text-xl font-semibold text-white"},yt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},ht={class:"text-xl font-semibold text-red-400"},wt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},Et={class:"text-xl font-semibold text-white"},kt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},Dt={class:"text-xl font-semibold text-[#ffa236]"},St={class:"text-xs text-gray-400"},Nt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},Pt={class:"text-xl font-semibold text-gray-100"},Ft={class:"text-xs text-gray-400"},Ut={class:"overflow-x-auto bg-[#0f0f0f] rounded-lg shadow"},At={class:"min-w-full text-sm text-gray-300"},Mt={class:"bg-[#1c1c1c] text-gray-400 uppercase text-xs"},zt={key:0,class:"px-4 py-2 text-left"},It={key:1,class:"px-4 py-2 text-left"},Tt={class:"px-4 py-2 text-right"},Ct={key:0},Lt=["colspan"],Vt={class:"px-4 py-3 font-medium"},Bt={class:"px-4 py-3"},Ht={class:"px-4 py-3"},Rt={class:"text-s"},$t={key:0},jt={key:1},Gt={key:2,class:"text-gray-500 text-s"},Ot={key:3},Wt={class:"px-4 py-3"},Yt={key:0,class:"bg-[#2a2a2a] px-2 py-1 rounded text-s capitalize"},qt={key:1,class:"text-gray-500"},Jt={class:"px-4 py-3"},Kt={key:0,class:"px-4 py-3"},Qt={class:"text-xs"},Xt={key:0},Zt={key:1},te={key:1,class:"px-4 py-3"},ee={class:"text-xs"},se={class:"px-4 py-3"},oe={class:"px-4 py-3"},ae={class:"px-4 py-3 text-right space-x-2"},ne=["onClick"],le={__name:"Index",props:{events:Object,artists:Array,canManageEvents:{type:Boolean,default:!1}},setup(z){const p=z,w=h("todos"),g=h("todos"),E=h(""),k=h(""),b=(o,t="USD")=>{const s=Number(o??0);if(Number.isNaN(s))return`${t} 0,00`;try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:t}).format(s)}catch{return`${t} ${s.toFixed(2)}`}},f=h(p.events&&p.events.data?[...p.events.data]:[]);I(()=>p.events,o=>{f.value=o&&o.data?[...o.data]:o||[]});const y=o=>{if(!o)return null;const t=new Date(o);return Number.isNaN(t.getTime())?null:(t.setHours(0,0,0,0),t)},B=()=>{const o=new Date;if(o.setHours(0,0,0,0),g.value==="personalizado")return{start:y(E.value),end:y(k.value)};const t=o.getFullYear(),s=o.getMonth();switch(g.value){case"mes_actual":return{start:new Date(t,s,1),end:new Date(t,s+1,0)};case"ultimo_mes":return{start:new Date(t,s-1,1),end:new Date(t,s,0)};case"ultimos_3_meses":return{start:new Date(t,s-2,1),end:new Date(t,s+1,0)};case"este_ano":return{start:new Date(t,0,1),end:new Date(t,11,31)};default:return{start:null,end:null}}},H=(o,t)=>!(!o||t.start&&o<t.start||t.end&&o>t.end),R=o=>String(o.status||"").toLowerCase()==="pagado"||!!o.is_paid,$=o=>{if(typeof o.is_upcoming=="boolean")return o.is_upcoming;const t=y(o.event_date);if(!t)return!1;const s=new Date;return s.setHours(0,0,0,0),t>s},j=o=>{if(typeof o.is_past=="boolean")return o.is_past;const t=y(o.event_date);if(!t)return!1;const s=new Date;return s.setHours(0,0,0,0),t<s},x=D(()=>{const o=f.value.length?f.value:p.events&&p.events.data?p.events.data:p.events||[],t=B();return o.filter(s=>{var r,u;if(w.value!=="todos"&&(((r=s.main_artist)==null?void 0:r.id)||((u=s.mainArtist)==null?void 0:u.id)||s.main_artist_id)!=w.value)return!1;if(t.start||t.end){const m=y(s.event_date);if(!H(m,t))return!1}return!0})}),v=D(()=>{const o=x.value.length,t=x.value.filter($).length,s=x.value.filter(j).length,r=x.value.filter(R).length,u=Math.max(o-r,0),m=x.value.reduce((P,i)=>P+Number(i.show_fee_total??0),0);return{totalEvents:o,upcomingEvents:t,pastEvents:s,paidEvents:r,pendingEvents:u,totalFee:m}}),_=D(()=>{let o=0,t=0,s=0,r=0;for(const i of x.value)o+=Number(i.total_paid_base??i.totalPaid??i.total_paid??0),t+=Number(i.total_expenses_base??i.totalExpenses??i.total_expenses??0),s+=Number(i.artist_share_estimated_base??i.artist_share_estimated??i.artist_share??0),r+=Number(i.label_share_estimated_base??i.label_share_estimated??i.label_share??0);const u=o-t,m=u!==0?s/(u||1)*100:0,P=u!==0?r/(u||1)*100:0;return{totalPaid:o,totalExpenses:t,net:u,artistShare:s,labelShare:r,artistPct:m,labelPct:P}}),c=D(()=>!!p.canManageEvents);I(g,o=>{o!=="personalizado"&&(E.value="",k.value="")});const G=o=>f.value.findIndex(t=>t.id===o),O=async o=>{if(!confirm("Â¿Eliminar este evento? Esta acciÃ³n no se puede deshacer."))return;const t=G(o);if(t===-1)return;const s=[...f.value];f.value.splice(t,1);try{const r=await J.delete(route("admin.events.destroy",o));if(!(r.status>=200&&r.status<300))throw new Error("Server returned unexpected status: "+r.status)}catch(r){f.value=s,alert("No fue posible eliminar el evento. Intenta nuevamente."),console.error("Error deleting event",r)}};return(o,t)=>(n(),F(K,{title:"Eventos"},{default:S(()=>[e("div",X,[e("div",null,[t[9]||(t[9]=e("h1",{class:"text-2xl font-semibold text-white mb-3"},"ğŸ« Eventos",-1)),e("div",Z,[e("div",tt,[t[5]||(t[5]=e("label",{class:"text-sm text-gray-400"},"Filtrar por artista:",-1)),N(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),class:"bg-[#1c1c1c] text-white border border-[#2a2a2a] rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#ffa236]"},[t[4]||(t[4]=e("option",{value:"todos"},"Todos los artistas",-1)),(n(!0),l(T,null,C(z.artists,s=>(n(),l("option",{key:s.id,value:s.id},a(s.name),9,et))),128))],512),[[L,w.value]])]),e("div",st,[t[7]||(t[7]=e("label",{class:"text-sm text-gray-400"},"Periodo:",-1)),N(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),class:"bg-[#1c1c1c] text-white border border-[#2a2a2a] rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#ffa236]"},[...t[6]||(t[6]=[e("option",{value:"todos"},"Todos",-1),e("option",{value:"mes_actual"},"Este mes",-1),e("option",{value:"ultimo_mes"},"Mes pasado",-1),e("option",{value:"ultimos_3_meses"},"Ãšltimos 3 meses",-1),e("option",{value:"este_ano"},"Este aÃ±o",-1),e("option",{value:"personalizado"},"Personalizado",-1)])],512),[[L,g.value]])]),g.value==="personalizado"?(n(),l("div",ot,[N(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>E.value=s),type:"date",class:"bg-[#1c1c1c] text-white border border-[#2a2a2a] rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#ffa236]","aria-label":"Desde"},null,512),[[V,E.value]]),t[8]||(t[8]=e("span",{class:"text-gray-500 text-sm"},"â€”",-1)),N(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>k.value=s),type:"date",class:"bg-[#1c1c1c] text-white border border-[#2a2a2a] rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#ffa236]","aria-label":"Hasta"},null,512),[[V,k.value]])])):d("",!0)])]),c.value?(n(),F(U(A),{key:0,href:o.route("admin.events.create"),class:"bg-[#ffa236] hover:bg-[#ffb54d] text-black font-semibold px-4 py-2 rounded-md transition-colors"},{default:S(()=>[...t[10]||(t[10]=[M("+ Nuevo evento",-1)])]),_:1},8,["href"])):d("",!0)]),c.value?(n(),l("div",at,[e("div",nt,[t[11]||(t[11]=e("p",{class:"text-xs text-gray-400"},"Total eventos",-1)),e("p",lt,a(v.value.totalEvents),1)]),e("div",rt,[t[12]||(t[12]=e("p",{class:"text-xs text-gray-400"},"PrÃ³ximos",-1)),e("p",dt,a(v.value.upcomingEvents),1)]),e("div",it,[t[13]||(t[13]=e("p",{class:"text-xs text-gray-400"},"Pasados",-1)),e("p",ut,a(v.value.pastEvents),1)]),e("div",ct,[t[14]||(t[14]=e("p",{class:"text-xs text-gray-400"},"Pagados",-1)),e("p",pt,a(v.value.paidEvents),1)]),e("div",xt,[t[15]||(t[15]=e("p",{class:"text-xs text-gray-400"},"Pendientes",-1)),e("p",ft,a(v.value.pendingEvents),1)]),e("div",_t,[t[16]||(t[16]=e("p",{class:"text-xs text-gray-400"},"Fee negociado",-1)),e("p",mt,a(b(v.value.totalFee,"USD")),1)])])):d("",!0),c.value?(n(),l("div",gt,[e("div",bt,[t[17]||(t[17]=e("p",{class:"text-xs text-gray-400"},"Ingresos totales",-1)),e("p",vt,a(b(_.value.totalPaid,"USD")),1)]),e("div",yt,[t[18]||(t[18]=e("p",{class:"text-xs text-gray-400"},"Gastos totales",-1)),e("p",ht,a(b(_.value.totalExpenses,"USD")),1)]),e("div",wt,[t[19]||(t[19]=e("p",{class:"text-xs text-gray-400"},"Resultado neto",-1)),e("p",Et,a(b(_.value.net,"USD")),1)]),e("div",kt,[t[20]||(t[20]=e("p",{class:"text-xs text-gray-400"},"70% Artista",-1)),e("p",Dt,a(b(_.value.artistShare,"USD")),1),e("p",St,a(Math.round(_.value.artistPct))+"%",1)]),e("div",Nt,[t[21]||(t[21]=e("p",{class:"text-xs text-gray-400"},"30% CompaÃ±Ã­a",-1)),e("p",Pt,a(b(_.value.labelShare,"USD")),1),e("p",Ft,a(Math.round(_.value.labelPct))+"%",1)])])):d("",!0),e("div",Ut,[e("table",At,[e("thead",Mt,[e("tr",null,[t[22]||(t[22]=e("th",{class:"px-4 py-2 text-left"},"TÃ­tulo",-1)),t[23]||(t[23]=e("th",{class:"px-4 py-2 text-left"},"Fecha",-1)),t[24]||(t[24]=e("th",{class:"px-4 py-2 text-left"},"UbicaciÃ³n",-1)),t[25]||(t[25]=e("th",{class:"px-4 py-2 text-left"},"Tipo",-1)),t[26]||(t[26]=e("th",{class:"px-4 py-2 text-left"},"Estado",-1)),c.value?(n(),l("th",zt,"Fee / Moneda")):d("",!0),c.value?(n(),l("th",It,"% Anticipo")):d("",!0),t[27]||(t[27]=e("th",{class:"px-4 py-2 text-left"},"Pago final",-1)),t[28]||(t[28]=e("th",{class:"px-4 py-2 text-left"},"Artista Principal",-1)),e("th",Tt,a(c.value?"Acciones":"Finanzas"),1)])]),e("tbody",null,[x.value.length===0?(n(),l("tr",Ct,[e("td",{colspan:c.value?10:8,class:"px-4 py-6 text-center text-gray-500"}," No hay eventos con los filtros seleccionados. ",8,Lt)])):d("",!0),(n(!0),l(T,null,C(x.value,s=>{var r,u;return n(),l("tr",{key:s.id,class:"border-b border-[#2a2a2a] hover:bg-[#181818]"},[e("td",Vt,a(s.title),1),e("td",Bt,a(s.event_date?new Date(s.event_date).toLocaleDateString("es-ES"):"-"),1),e("td",Ht,[e("div",Rt,[s.city||s.country?(n(),l("p",$t,a(s.city)+a(s.city&&s.country?",":"")+" "+a(s.country),1)):d("",!0),s.location?(n(),l("p",jt,a(s.location),1)):d("",!0),s.venue_address?(n(),l("p",Gt,"Venue: "+a(s.venue_address),1)):d("",!0),!s.city&&!s.country&&!s.location&&!s.venue_address?(n(),l("p",Ot,"â€”")):d("",!0)])]),e("td",Wt,[s.event_type?(n(),l("span",Yt,a(s.event_type),1)):(n(),l("span",qt,"â€”"))]),e("td",Jt,[e("span",{class:W(["px-2 py-1 rounded-full text-s font-semibold",s.status==="pagado"?"bg-green-500/20 text-green-300":s.status==="confirmado"?"bg-blue-500/20 text-blue-300":s.status==="pospuesto"?"bg-orange-500/20 text-orange-300":s.status==="cancelado"?"bg-red-500/20 text-red-300":"bg-yellow-500/20 text-yellow-300"])},a(s.status||"Sin estado"),3)]),c.value?(n(),l("td",Kt,[e("div",Qt,[s.show_fee_total?(n(),l("p",Xt,a(s.currency||"USD")+" "+a(Number(s.show_fee_total).toFixed(2)),1)):(n(),l("p",Zt,"â€”"))])])):d("",!0),c.value?(n(),l("td",te,[e("span",ee,a(s.advance_percentage??50)+"%",1)])):d("",!0),e("td",se,a(s.full_payment_due_date?new Date(s.full_payment_due_date).toLocaleDateString("es-ES"):"â€”"),1),e("td",oe,a(((r=s.main_artist)==null?void 0:r.name)||((u=s.mainArtist)==null?void 0:u.name)||"-"),1),e("td",ae,[c.value?(n(),F(U(A),{key:0,href:o.route("admin.events.edit",s.id),class:"text-[#ffa236] hover:underline text-sm"},{default:S(()=>[...t[29]||(t[29]=[M(" Editar ",-1)])]),_:1},8,["href"])):d("",!0),Y(U(A),{href:o.route("admin.events.finance",s.id),class:"text-green-400 hover:underline text-sm"},{default:S(()=>[...t[30]||(t[30]=[M(" Finanzas ",-1)])]),_:1},8,["href"]),c.value?(n(),l("button",{key:1,type:"button",class:"text-red-400 hover:underline text-sm",onClick:q(m=>O(s.id),["prevent"])}," Eliminar ",8,ne)):d("",!0)])])}),128))])])])]),_:1}))}},pe=Q(le,[["__scopeId","data-v-7b13088e"]]);export{pe as default};
