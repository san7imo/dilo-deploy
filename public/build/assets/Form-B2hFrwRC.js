import{e as u,o as d,a as t,h as U,F as I,i as j,n as C,f as v,t as b,d as V,u as F,b as T,j as _,v as y,g as o,k as A,l as R}from"./app-wqEFckxb.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const D={class:"space-y-4"},N={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},L={class:"relative bg-[#0f0f0f] border-2 border-dashed border-[#2a2a2a] rounded-lg overflow-hidden hover:border-[#ffa236]/50 transition-all aspect-square"},z=["src","alt"],O={key:1,class:"w-full h-full flex flex-col items-center justify-center text-gray-500 group-hover:text-[#ffa236] transition-colors"},B={class:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2"},M=["onClick"],X={class:"bg-[#ffa236] hover:bg-[#ffb54d] text-black rounded-full w-10 h-10 flex items-center justify-center cursor-pointer transition-colors"},P=["name","onChange"],q={class:"mt-2"},G={class:"text-gray-300 text-sm font-medium block"},H={class:"text-gray-500 text-xs mt-1"},Y={__name:"ImageGrid",props:{images:{type:Object,default:()=>({banner_home:{url:null,id:null},banner_artist:{url:null,id:null},carousel_home:{url:null,id:null},carousel_discography:{url:null,id:null}})},fileInputs:{type:Object,default:()=>({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null})}},emits:["delete-image","file-selected"],setup(g,{emit:l}){const p=g,k=l,s={banner_home:{label:"Banner Principal (Home)",icon:"fa-image"},banner_artist:{label:"Banner del Artista",icon:"fa-image"},carousel_home:{label:"Imagen Carrusel Home",icon:"fa-images"},carousel_discography:{label:"Imagen Carrusel Discograf√≠a",icon:"fa-images"}},w=f=>{confirm("¬øEliminar esta imagen? Se eliminar√° de ImageKit.")&&k("delete-image",f)},x=(f,c)=>{const i=c.target.files[0];i&&(k("file-selected",{fieldKey:f,file:i}),console.log(`üìÅ Archivo seleccionado para ${f}:`,i.name))},$=f=>{var c,i;return((c=p.fileInputs[`${f}_file`])==null?void 0:c.preview)||((i=p.images[f])==null?void 0:i.url)};return(f,c)=>(d(),u("div",D,[c[3]||(c[3]=t("h3",{class:"text-[#ffa236] font-semibold flex items-center gap-2"},[t("i",{class:"fa-solid fa-images"}),U("Im√°genes ")],-1)),t("div",N,[(d(!0),u(I,null,j(Object.keys(s),i=>{var n,e;return d(),u("div",{key:i,class:"group relative"},[t("div",L,[$(i)?(d(),u("img",{key:0,src:$(i),alt:s[i].label,class:"w-full h-full object-cover"},null,8,z)):(d(),u("div",O,[t("i",{class:C(`fa-solid ${s[i].icon} text-3xl mb-2`)},null,2),c[0]||(c[0]=t("span",{class:"text-xs text-center"},"Sin imagen",-1))])),t("div",B,[(n=p.images[i])!=null&&n.url?(d(),u("button",{key:0,onClick:a=>w(i),type:"button",class:"bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center transition-colors",title:"Eliminar imagen"},[...c[1]||(c[1]=[t("i",{class:"fa-solid fa-trash text-sm"},null,-1)])],8,M)):v("",!0),t("label",X,[c[2]||(c[2]=t("i",{class:"fa-solid fa-plus text-sm"},null,-1)),t("input",{type:"file",name:`${i}_file`,accept:"image/*",class:"hidden",onChange:a=>x(i,a)},null,40,P)])])]),t("div",q,[t("label",G,b(s[i].label),1),t("p",H,b((e=p.images[i])!=null&&e.url?"‚úÖ Subida":"‚≠ï Vac√≠a"),1)])])}),128))]),c[4]||(c[4]=t("div",{class:"bg-[#0f0f0f] border border-[#2a2a2a] rounded-lg p-3 text-sm text-gray-400"},[t("p",{class:"flex items-start gap-2"},[t("i",{class:"fa-solid fa-circle-info text-[#ffa236] mt-0.5 flex-shrink-0"}),t("span",null,"Todos los cambios en im√°genes se sincronizan autom√°ticamente al guardar el artista.")])],-1))]))}},J=E(Y,[["__scopeId","data-v-ee177a42"]]),W=g=>{if(typeof document>"u")return"";const l=g.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),p=document.cookie.match(new RegExp(`(?:^|; )${l}=([^;]*)`));return p?decodeURIComponent(p[1]):""},Q=()=>W("XSRF-TOKEN"),Z=()=>{const g=Q();return g?{"X-XSRF-TOKEN":g}:{}},K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ee={key:0,class:"text-red-500 text-sm mt-1"},te={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},se={key:0,class:"text-red-500 text-sm mt-1"},le={key:0,class:"text-red-500 text-sm mt-1"},ae={key:1,class:"text-xs text-gray-500 mt-1"},oe=["value"],re={key:0,class:"mt-4"},ie={class:"w-full aspect-video rounded-lg overflow-hidden bg-black/50 border border-[#2a2a2a]"},ne=["src"],ue=["src"],de={key:2,class:"text-gray-400 p-4"},ce={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},me={class:"text-gray-300 text-sm"},pe=["onUpdate:modelValue"],fe={class:"flex justify-end"},ge={type:"submit",class:"btn-primary"},_e={__name:"Form",props:{artist:{type:Object,default:()=>({})},genres:{type:Array,default:()=>[]},mode:{type:String,default:"create"}},setup(g){var i;const l=g,p=V(!1),k=()=>{const n={spotify:"",youtube:"",instagram:"",tiktok:"",facebook:"",x:"",apple:"",amazon:""};if(l.artist.social_links_formatted&&typeof l.artist.social_links_formatted=="object")return{...n,...l.artist.social_links_formatted};if(!l.artist.social_links)return n;if(typeof l.artist.social_links=="object"&&!Array.isArray(l.artist.social_links))return{...n,...l.artist.social_links};if(Array.isArray(l.artist.social_links)){const e={...n};return l.artist.social_links.forEach(a=>{if(a.platform&&a.url){const m=a.platform.toLowerCase();e[m]=a.url}}),e}return n},s=F({name:l.artist.name||"",bio:l.artist.bio||"",country:l.artist.country||"",genre_id:l.artist.genre_id||"",social_links:k(),presentation_video_url:l.artist.presentation_video_url||"",email:((i=l.artist.user)==null?void 0:i.email)||"",password:"",banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),w=V({banner_home:{url:l.artist.banner_home_url||null,id:l.artist.banner_home_id||null},banner_artist:{url:l.artist.banner_artist_url||null,id:l.artist.banner_artist_id||null},carousel_home:{url:l.artist.carousel_home_url||null,id:l.artist.carousel_home_id||null},carousel_discography:{url:l.artist.carousel_discography_url||null,id:l.artist.carousel_discography_id||null}}),x=V({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),$=({fieldKey:n,file:e})=>{const a=`${n}_file`;s[a]=e;const m=new FileReader;m.onload=r=>{x.value[a]={preview:r.target.result}},m.readAsDataURL(e),console.log(`‚úÖ Archivo ${a} seleccionado:`,e.name)},f=async n=>{var e;if(!p.value){if(!((e=l.artist)!=null&&e.id)){alert("No se encontr√≥ el artista.");return}p.value=!0;try{const a=await fetch(route("admin.artists.deleteImage",l.artist.id),{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json",...Z()},body:JSON.stringify({field:n})});if(console.log("üîé Status delete:",a.status),!a.ok){const S=await a.text();console.error("‚ùå Respuesta del servidor:",S),alert("No se pudo eliminar la imagen");return}const m=await a.json();console.log("‚úÖ Imagen eliminada correctamente",m);const r=`${n}_url`,h=`${n}_id`;w.value[n]={url:m.artist[r],id:m.artist[h]},x.value[`${n}_file`]=null}catch(a){console.error("Error:",a),alert("Error al eliminar la imagen")}finally{p.value=!1}}},c=()=>{console.log("üü° Enviando formulario..."),console.log("üì¶ Datos actuales del form:",s.data());const n="post",e=l.mode==="edit"?route("admin.artists.update",l.artist.id):route("admin.artists.store");s.transform(a=>({...a,_method:l.mode==="edit"?"put":"post",social_links:a.social_links})).submit(n,e,{forceFormData:!0,onStart:()=>console.log("üöÄ Enviando request a:",e),onProgress:a=>console.log("üì§ Subiendo...",a),onError:a=>{console.group("‚ùå Errores de validaci√≥n");for(const[m,r]of Object.entries(a))console.log(`- ${m}:`,r);console.groupEnd()},onSuccess:()=>console.log("‚úÖ Artista creado/actualizado correctamente"),onFinish:()=>console.log("üèÅ Proceso finalizado")})};return(n,e)=>{var a,m;return d(),u("form",{onSubmit:R(c,["prevent"]),class:"space-y-6"},[t("div",K,[t("div",null,[e[7]||(e[7]=t("label",{class:"text-gray-300 text-sm"},"Nombre del artista",-1)),_(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).name=r),type:"text",class:"input",placeholder:"Nombre art√≠stico"},null,512),[[y,o(s).name]]),o(s).errors.name?(d(),u("p",ee,b(o(s).errors.name),1)):v("",!0)]),t("div",te,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-gray-300 text-sm"},"Correo del artista",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).email=r),type:"email",class:"input",placeholder:"artista@email.com"},null,512),[[y,o(s).email]]),o(s).errors.email?(d(),u("p",se,b(o(s).errors.email),1)):v("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"text-gray-300 text-sm"},"Contrase√±a",-1)),_(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o(s).password=r),type:"password",class:"input",placeholder:"Minimo 8 caracteres"},null,512),[[y,o(s).password]]),o(s).errors.password?(d(),u("p",le,b(o(s).errors.password),1)):v("",!0),l.mode==="edit"?(d(),u("p",ae," Deja en blanco para no cambiarla. ")):v("",!0)])]),t("div",null,[e[10]||(e[10]=t("label",{class:"text-gray-300 text-sm"},"Pa√≠s",-1)),_(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>o(s).country=r),type:"text",class:"input",placeholder:"Ej: Colombia"},null,512),[[y,o(s).country]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-gray-300 text-sm"},"G√©nero musical",-1)),_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=r=>o(s).genre_id=r),class:"input"},[e[11]||(e[11]=t("option",{disabled:"",value:""},"Selecciona un g√©nero",-1)),(d(!0),u(I,null,j(g.genres,r=>(d(),u("option",{key:r.id,value:r.id},b(r.name),9,oe))),128))],512),[[A,o(s).genre_id]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"text-gray-300 text-sm"},"Biograf√≠a",-1)),_(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=r=>o(s).bio=r),rows:"4",class:"input",placeholder:"Breve descripci√≥n del artista..."},null,512),[[y,o(s).bio]])]),T(J,{images:w.value,"file-inputs":x.value,onFileSelected:$,onDeleteImage:f},null,8,["images","file-inputs"]),t("div",null,[e[15]||(e[15]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Video de Presentaci√≥n ",-1)),e[16]||(e[16]=t("label",{class:"text-gray-300 text-sm"},"URL del Video (YouTube/Vimeo)",-1)),_(t("input",{"onUpdate:modelValue":e[6]||(e[6]=r=>o(s).presentation_video_url=r),type:"url",class:"input",placeholder:"https://www.youtube.com/watch?v=... o https://vimeo.com/..."},null,512),[[y,o(s).presentation_video_url]]),e[17]||(e[17]=t("p",{class:"text-gray-500 text-xs mt-2"}," Soporta YouTube y Vimeo. Se mostrar√° en el perfil p√∫blico del artista. ",-1)),o(s).presentation_video_url?(d(),u("div",re,[e[14]||(e[14]=t("p",{class:"text-gray-300 text-sm mb-2"},"Vista previa:",-1)),t("div",ie,[o(s).presentation_video_url.includes("youtube")?(d(),u("iframe",{key:0,src:`https://www.youtube.com/embed/${(a=o(s).presentation_video_url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/))==null?void 0:a[1]}`,class:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ne)):o(s).presentation_video_url.includes("vimeo")?(d(),u("iframe",{key:1,src:`https://player.vimeo.com/video/${(m=o(s).presentation_video_url.match(/vimeo\.com\/(\d+)/))==null?void 0:m[1]}`,class:"w-full h-full",allow:"autoplay; fullscreen",allowfullscreen:""},null,8,ue)):(d(),u("p",de," URL no v√°lida. Usa YouTube o Vimeo. "))])])):v("",!0)]),t("div",null,[e[18]||(e[18]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Redes sociales / Streaming ",-1)),t("div",ce,[(d(),u(I,null,j({spotify:"Spotify",youtube:"YouTube",instagram:"Instagram",tiktok:"TikTok",facebook:"Facebook",x:"X / Twitter",apple:"Apple Music",amazon:"Amazon Music"},(r,h)=>t("div",{key:h},[t("label",me,b(r),1),_(t("input",{"onUpdate:modelValue":S=>o(s).social_links[h]=S,type:"url",class:"input",placeholder:"https://..."},null,8,pe),[[y,o(s).social_links[h]]])])),64))]),e[19]||(e[19]=t("p",{class:"text-gray-500 text-xs mt-2"}," Solo se guardar√°n las redes con una URL v√°lida. ",-1))]),t("div",fe,[t("button",ge,b(l.mode==="edit"?"Actualizar artista":"Guardar artista"),1)])],32)}}},xe=E(_e,[["__scopeId","data-v-c133754b"]]);export{xe as default};
