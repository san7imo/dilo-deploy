import{d as S,s as b,y as P,c as g,w as y,a as s,f as u,j as U,e as l,o as r,F as N,i as A,t as a,k as C,g as h,m as v,h as k,n as B,b as L,l as z,A as T}from"./app-CzY7Gfd0.js";import{A as $}from"./AdminLayout-DY30SRq5.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */import"./responsive-blanco-DOkwJ8BK.js";const V={class:"flex justify-between items-center mb-6"},G={class:"flex items-center gap-3"},O=["value"],R={class:"grid grid-cols-1 sm:grid-cols-5 gap-4 mb-6"},q={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},H={class:"text-xl font-semibold text-white"},J={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},K={class:"text-xl font-semibold text-red-400"},Q={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},W={class:"text-xl font-semibold text-white"},X={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},Y={class:"text-xl font-semibold text-[#ffa236]"},Z={class:"text-xs text-gray-400"},tt={class:"rounded-lg p-4 bg-[#0f0f0f] border border-[#232323]"},et={class:"text-xl font-semibold text-gray-100"},st={class:"text-xs text-gray-400"},at={class:"overflow-x-auto bg-[#0f0f0f] rounded-lg shadow"},ot={class:"min-w-full text-sm text-gray-300"},rt={class:"bg-[#1c1c1c] text-gray-400 uppercase text-xs"},lt={key:0,class:"px-4 py-2 text-left"},nt={key:1,class:"px-4 py-2 text-left"},dt={class:"px-4 py-2 text-right"},it={class:"px-4 py-3 font-medium"},ut={class:"px-4 py-3"},ct={class:"px-4 py-3"},pt={class:"text-s"},xt={key:0},_t={key:1},ft={key:2,class:"text-gray-500 text-s"},mt={key:3},yt={class:"px-4 py-3"},bt={key:0,class:"bg-[#2a2a2a] px-2 py-1 rounded text-s capitalize"},gt={key:1,class:"text-gray-500"},ht={class:"px-4 py-3"},vt={key:0,class:"px-4 py-3"},kt={class:"text-xs"},Et={key:0},wt={key:1},St={key:1,class:"px-4 py-3"},Nt={class:"text-xs"},At={class:"px-4 py-3"},Dt={class:"px-4 py-3"},Ft={class:"px-4 py-3 text-right space-x-2"},It=["onClick"],Mt={__name:"Index",props:{events:Object,artists:Array,canManageEvents:{type:Boolean,default:!1}},setup(E){const c=E,m=S("todos"),f=(o,t="USD")=>{const e=Number(o??0);if(Number.isNaN(e))return`${t} 0,00`;try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:t}).format(e)}catch{return`${t} ${e.toFixed(2)}`}},D=b(()=>{const o=c.events&&c.events.data?c.events.data:c.events||[];return m.value==="todos"?o:o.filter(t=>{var n,i;return(((n=t.main_artist)==null?void 0:n.id)||((i=t.mainArtist)==null?void 0:i.id)||t.main_artist_id)==m.value})}),x=b(()=>{let o=0,t=0,e=0,n=0;for(const d of D.value)o+=Number(d.total_paid_base??d.totalPaid??d.total_paid??0),t+=Number(d.total_expenses_base??d.totalExpenses??d.total_expenses??0),e+=Number(d.artist_share_estimated_base??d.artist_share_estimated??d.artist_share??0),n+=Number(d.label_share_estimated_base??d.label_share_estimated??d.label_share??0);const i=o-t,w=i!==0?e/(i||1)*100:0,M=i!==0?n/(i||1)*100:0;return{totalPaid:o,totalExpenses:t,net:i,artistShare:e,labelShare:n,artistPct:w,labelPct:M}}),p=b(()=>!!c.canManageEvents),_=S(c.events&&c.events.data?[...c.events.data]:[]);P(()=>c.events,o=>{_.value=o&&o.data?[...o.data]:o||[]});const F=o=>_.value.findIndex(t=>t.id===o),I=async o=>{if(!confirm("Â¿Eliminar este evento? Esta acciÃ³n no se puede deshacer."))return;const t=F(o);if(t===-1)return;const e=[..._.value];_.value.splice(t,1);try{const n=await T.delete(route("admin.events.destroy",o));if(!(n.status>=200&&n.status<300))throw new Error("Server returned unexpected status: "+n.status)}catch(n){_.value=e,alert("No fue posible eliminar el evento. Intenta nuevamente."),console.error("Error deleting event",n)}};return(o,t)=>(r(),g($,{title:"Eventos"},{default:y(()=>[s("div",V,[s("div",null,[t[3]||(t[3]=s("h1",{class:"text-2xl font-semibold text-white mb-3"},"ğŸ« Eventos",-1)),s("div",G,[t[2]||(t[2]=s("label",{class:"text-sm text-gray-400"},"Filtrar por artista:",-1)),U(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"bg-[#1c1c1c] text-white border border-[#2a2a2a] rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#ffa236]"},[t[1]||(t[1]=s("option",{value:"todos"},"Todos los artistas",-1)),(r(!0),l(N,null,A(E.artists,e=>(r(),l("option",{key:e.id,value:e.id},a(e.name),9,O))),128))],512),[[C,m.value]])])]),p.value?(r(),g(h(v),{key:0,href:o.route("admin.events.create"),class:"bg-[#ffa236] hover:bg-[#ffb54d] text-black font-semibold px-4 py-2 rounded-md transition-colors"},{default:y(()=>[...t[4]||(t[4]=[k("+ Nuevo evento",-1)])]),_:1},8,["href"])):u("",!0)]),s("div",R,[s("div",q,[t[5]||(t[5]=s("p",{class:"text-xs text-gray-400"},"Ingresos totales",-1)),s("p",H,a(f(x.value.totalPaid,"USD")),1)]),s("div",J,[t[6]||(t[6]=s("p",{class:"text-xs text-gray-400"},"Gastos totales",-1)),s("p",K,a(f(x.value.totalExpenses,"USD")),1)]),s("div",Q,[t[7]||(t[7]=s("p",{class:"text-xs text-gray-400"},"Resultado neto",-1)),s("p",W,a(f(x.value.net,"USD")),1)]),s("div",X,[t[8]||(t[8]=s("p",{class:"text-xs text-gray-400"},"70% Artista",-1)),s("p",Y,a(f(x.value.artistShare,"USD")),1),s("p",Z,a(Math.round(x.value.artistPct))+"%",1)]),s("div",tt,[t[9]||(t[9]=s("p",{class:"text-xs text-gray-400"},"30% CompaÃ±Ã­a",-1)),s("p",et,a(f(x.value.labelShare,"USD")),1),s("p",st,a(Math.round(x.value.labelPct))+"%",1)])]),s("div",at,[s("table",ot,[s("thead",rt,[s("tr",null,[t[10]||(t[10]=s("th",{class:"px-4 py-2 text-left"},"TÃ­tulo",-1)),t[11]||(t[11]=s("th",{class:"px-4 py-2 text-left"},"Fecha",-1)),t[12]||(t[12]=s("th",{class:"px-4 py-2 text-left"},"UbicaciÃ³n",-1)),t[13]||(t[13]=s("th",{class:"px-4 py-2 text-left"},"Tipo",-1)),t[14]||(t[14]=s("th",{class:"px-4 py-2 text-left"},"Estado",-1)),p.value?(r(),l("th",lt,"Fee / Moneda")):u("",!0),p.value?(r(),l("th",nt,"% Anticipo")):u("",!0),t[15]||(t[15]=s("th",{class:"px-4 py-2 text-left"},"Pago final",-1)),t[16]||(t[16]=s("th",{class:"px-4 py-2 text-left"},"Artista Principal",-1)),s("th",dt,a(p.value?"Acciones":"Finanzas"),1)])]),s("tbody",null,[(r(!0),l(N,null,A(_.value,e=>{var n,i;return r(),l("tr",{key:e.id,class:"border-b border-[#2a2a2a] hover:bg-[#181818]"},[s("td",it,a(e.title),1),s("td",ut,a(e.event_date?new Date(e.event_date).toLocaleDateString("es-ES"):"-"),1),s("td",ct,[s("div",pt,[e.city||e.country?(r(),l("p",xt,a(e.city)+a(e.city&&e.country?",":"")+" "+a(e.country),1)):u("",!0),e.location?(r(),l("p",_t,a(e.location),1)):u("",!0),e.venue_address?(r(),l("p",ft,"Venue: "+a(e.venue_address),1)):u("",!0),!e.city&&!e.country&&!e.location&&!e.venue_address?(r(),l("p",mt,"â€”")):u("",!0)])]),s("td",yt,[e.event_type?(r(),l("span",bt,a(e.event_type),1)):(r(),l("span",gt,"â€”"))]),s("td",ht,[s("span",{class:B(["px-2 py-1 rounded-full text-s font-semibold",e.status==="pagado"?"bg-green-500/20 text-green-300":e.status==="confirmado"?"bg-blue-500/20 text-blue-300":e.status==="pospuesto"?"bg-orange-500/20 text-orange-300":e.status==="cancelado"?"bg-red-500/20 text-red-300":"bg-yellow-500/20 text-yellow-300"])},a(e.status||"Sin estado"),3)]),p.value?(r(),l("td",vt,[s("div",kt,[e.show_fee_total?(r(),l("p",Et,a(e.currency||"USD")+" "+a(Number(e.show_fee_total).toFixed(2)),1)):(r(),l("p",wt,"â€”"))])])):u("",!0),p.value?(r(),l("td",St,[s("span",Nt,a(e.advance_percentage??50)+"%",1)])):u("",!0),s("td",At,a(e.full_payment_due_date?new Date(e.full_payment_due_date).toLocaleDateString("es-ES"):"â€”"),1),s("td",Dt,a(((n=e.main_artist)==null?void 0:n.name)||((i=e.mainArtist)==null?void 0:i.name)||"-"),1),s("td",Ft,[p.value?(r(),g(h(v),{key:0,href:o.route("admin.events.edit",e.id),class:"text-[#ffa236] hover:underline text-sm"},{default:y(()=>[...t[17]||(t[17]=[k(" Editar ",-1)])]),_:1},8,["href"])):u("",!0),L(h(v),{href:o.route("admin.events.finance",e.id),class:"text-green-400 hover:underline text-sm"},{default:y(()=>[...t[18]||(t[18]=[k(" Finanzas ",-1)])]),_:1},8,["href"]),p.value?(r(),l("button",{key:1,type:"button",class:"text-red-400 hover:underline text-sm",onClick:z(w=>I(e.id),["prevent"])}," Eliminar ",8,It)):u("",!0)])])}),128))])])])]),_:1}))}},zt=j(Mt,[["__scopeId","data-v-a0f29362"]]);export{zt as default};
