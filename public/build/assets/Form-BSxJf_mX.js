import{e as u,o as d,a as t,h as U,F as V,i as I,n as C,f as b,t as g,d as S,u as F,b as A,j as f,v as _,g as r,k as T,l as D}from"./app-DMZ2GxHc.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const L={class:"space-y-4"},N={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},R={class:"relative bg-[#0f0f0f] border-2 border-dashed border-[#2a2a2a] rounded-lg overflow-hidden hover:border-[#ffa236]/50 transition-all aspect-square"},z=["src","alt"],B={key:1,class:"w-full h-full flex flex-col items-center justify-center text-gray-500 group-hover:text-[#ffa236] transition-colors"},M={class:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2"},O=["onClick"],q={class:"bg-[#ffa236] hover:bg-[#ffb54d] text-black rounded-full w-10 h-10 flex items-center justify-center cursor-pointer transition-colors"},P=["name","onChange"],G={class:"mt-2"},X={class:"text-gray-300 text-sm font-medium block"},Y={class:"text-gray-500 text-xs mt-1"},H={__name:"ImageGrid",props:{images:{type:Object,default:()=>({banner_home:{url:null,id:null},banner_artist:{url:null,id:null},carousel_home:{url:null,id:null},carousel_discography:{url:null,id:null}})},fileInputs:{type:Object,default:()=>({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null})}},emits:["delete-image","file-selected"],setup(x,{emit:a}){const p=x,h=a,s={banner_home:{label:"Banner Principal (Home)",icon:"fa-image"},banner_artist:{label:"Banner del Artista",icon:"fa-image"},carousel_home:{label:"Imagen Carrusel Home",icon:"fa-images"},carousel_discography:{label:"Imagen Carrusel Discograf√≠a",icon:"fa-images"}},k=m=>{confirm("¬øEliminar esta imagen? Se eliminar√° de ImageKit.")&&h("delete-image",m)},y=(m,c)=>{const l=c.target.files[0];l&&(h("file-selected",{fieldKey:m,file:l}),console.log(`üìÅ Archivo seleccionado para ${m}:`,l.name))},w=m=>{var c,l;return((c=p.fileInputs[`${m}_file`])==null?void 0:c.preview)||((l=p.images[m])==null?void 0:l.url)};return(m,c)=>(d(),u("div",L,[c[3]||(c[3]=t("h3",{class:"text-[#ffa236] font-semibold flex items-center gap-2"},[t("i",{class:"fa-solid fa-images"}),U("Im√°genes ")],-1)),t("div",N,[(d(!0),u(V,null,I(Object.keys(s),l=>{var e,i;return d(),u("div",{key:l,class:"group relative"},[t("div",R,[w(l)?(d(),u("img",{key:0,src:w(l),alt:s[l].label,class:"w-full h-full object-cover"},null,8,z)):(d(),u("div",B,[t("i",{class:C(`fa-solid ${s[l].icon} text-3xl mb-2`)},null,2),c[0]||(c[0]=t("span",{class:"text-xs text-center"},"Sin imagen",-1))])),t("div",M,[(e=p.images[l])!=null&&e.url?(d(),u("button",{key:0,onClick:n=>k(l),type:"button",class:"bg-red-500 hover:bg-red-600 text-white rounded-full w-10 h-10 flex items-center justify-center transition-colors",title:"Eliminar imagen"},[...c[1]||(c[1]=[t("i",{class:"fa-solid fa-trash text-sm"},null,-1)])],8,O)):b("",!0),t("label",q,[c[2]||(c[2]=t("i",{class:"fa-solid fa-plus text-sm"},null,-1)),t("input",{type:"file",name:`${l}_file`,accept:"image/*",class:"hidden",onChange:n=>y(l,n)},null,40,P)])])]),t("div",G,[t("label",X,g(s[l].label),1),t("p",Y,g((i=p.images[l])!=null&&i.url?"‚úÖ Subida":"‚≠ï Vac√≠a"),1)])])}),128))]),c[4]||(c[4]=t("div",{class:"bg-[#0f0f0f] border border-[#2a2a2a] rounded-lg p-3 text-sm text-gray-400"},[t("p",{class:"flex items-start gap-2"},[t("i",{class:"fa-solid fa-circle-info text-[#ffa236] mt-0.5 flex-shrink-0"}),t("span",null,"Todos los cambios en im√°genes se sincronizan autom√°ticamente al guardar el artista.")])],-1))]))}},J=j(H,[["__scopeId","data-v-ee177a42"]]),W={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Q={key:0,class:"text-red-500 text-sm mt-1"},Z={key:0,class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},K={key:0,class:"text-red-500 text-sm mt-1"},ee={key:0,class:"text-red-500 text-sm mt-1"},te=["value"],se={key:0,class:"mt-4"},le={class:"w-full aspect-video rounded-lg overflow-hidden bg-black/50 border border-[#2a2a2a]"},ae=["src"],oe=["src"],re={key:2,class:"text-gray-400 p-4"},ie={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},ne={class:"text-gray-300 text-sm"},ue=["onUpdate:modelValue"],de={class:"flex justify-end"},ce={type:"submit",class:"btn-primary"},me={__name:"Form",props:{artist:{type:Object,default:()=>({})},genres:{type:Array,default:()=>[]},mode:{type:String,default:"create"}},setup(x){const a=x,p=S(!1),h=()=>{const l={spotify:"",youtube:"",instagram:"",tiktok:"",facebook:"",x:"",apple:"",amazon:""};if(a.artist.social_links_formatted&&typeof a.artist.social_links_formatted=="object")return{...l,...a.artist.social_links_formatted};if(!a.artist.social_links)return l;if(typeof a.artist.social_links=="object"&&!Array.isArray(a.artist.social_links))return{...l,...a.artist.social_links};if(Array.isArray(a.artist.social_links)){const e={...l};return a.artist.social_links.forEach(i=>{if(i.platform&&i.url){const n=i.platform.toLowerCase();e[n]=i.url}}),e}return l},s=F({name:a.artist.name||"",bio:a.artist.bio||"",country:a.artist.country||"",genre_id:a.artist.genre_id||"",social_links:h(),presentation_video_url:a.artist.presentation_video_url||"",email:"",password:"",banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),k=S({banner_home:{url:a.artist.banner_home_url||null,id:a.artist.banner_home_id||null},banner_artist:{url:a.artist.banner_artist_url||null,id:a.artist.banner_artist_id||null},carousel_home:{url:a.artist.carousel_home_url||null,id:a.artist.carousel_home_id||null},carousel_discography:{url:a.artist.carousel_discography_url||null,id:a.artist.carousel_discography_id||null}}),y=S({banner_home_file:null,banner_artist_file:null,carousel_home_file:null,carousel_discography_file:null}),w=({fieldKey:l,file:e})=>{const i=`${l}_file`;s[i]=e;const n=new FileReader;n.onload=o=>{y.value[i]={preview:o.target.result}},n.readAsDataURL(e),console.log(`‚úÖ Archivo ${i} seleccionado:`,e.name)},m=async l=>{var e,i;if(!p.value){if(!((e=a.artist)!=null&&e.id)){alert("No se encontr√≥ el artista.");return}p.value=!0;try{const n=await fetch(route("admin.artists.deleteImage",a.artist.id),{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-CSRF-TOKEN":(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.content},body:JSON.stringify({field:l})});if(console.log("üîé Status delete:",n.status),!n.ok){const E=await n.text();console.error("‚ùå Respuesta del servidor:",E),alert("No se pudo eliminar la imagen");return}const o=await n.json();console.log("‚úÖ Imagen eliminada correctamente",o);const v=`${l}_url`,$=`${l}_id`;k.value[l]={url:o.artist[v],id:o.artist[$]},y.value[`${l}_file`]=null}catch(n){console.error("Error:",n),alert("Error al eliminar la imagen")}finally{p.value=!1}}},c=()=>{console.log("üü° Enviando formulario..."),console.log("üì¶ Datos actuales del form:",s.data());const l="post",e=a.mode==="edit"?route("admin.artists.update",a.artist.id):route("admin.artists.store");s.transform(i=>({...i,_method:a.mode==="edit"?"put":"post",social_links:i.social_links})).submit(l,e,{forceFormData:!0,onStart:()=>console.log("üöÄ Enviando request a:",e),onProgress:i=>console.log("üì§ Subiendo...",i),onError:i=>{console.group("‚ùå Errores de validaci√≥n");for(const[n,o]of Object.entries(i))console.log(`- ${n}:`,o);console.groupEnd()},onSuccess:()=>console.log("‚úÖ Artista creado/actualizado correctamente"),onFinish:()=>console.log("üèÅ Proceso finalizado")})};return(l,e)=>{var i,n;return d(),u("form",{onSubmit:D(c,["prevent"]),class:"space-y-6"},[t("div",W,[t("div",null,[e[7]||(e[7]=t("label",{class:"text-gray-300 text-sm"},"Nombre del artista",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r(s).name=o),type:"text",class:"input",placeholder:"Nombre art√≠stico"},null,512),[[_,r(s).name]]),r(s).errors.name?(d(),u("p",Q,g(r(s).errors.name),1)):b("",!0)]),a.mode==="create"?(d(),u("div",Z,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-gray-300 text-sm"},"Correo del artista",-1)),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>r(s).email=o),type:"email",class:"input",placeholder:"artista@email.com"},null,512),[[_,r(s).email]]),r(s).errors.email?(d(),u("p",K,g(r(s).errors.email),1)):b("",!0)]),t("div",null,[e[9]||(e[9]=t("label",{class:"text-gray-300 text-sm"},"Contrase√±a",-1)),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>r(s).password=o),type:"password",class:"input",placeholder:"M√≠nimo 8 caracteres"},null,512),[[_,r(s).password]]),r(s).errors.password?(d(),u("p",ee,g(r(s).errors.password),1)):b("",!0)])])):b("",!0),t("div",null,[e[10]||(e[10]=t("label",{class:"text-gray-300 text-sm"},"Pa√≠s",-1)),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>r(s).country=o),type:"text",class:"input",placeholder:"Ej: Colombia"},null,512),[[_,r(s).country]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-gray-300 text-sm"},"G√©nero musical",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r(s).genre_id=o),class:"input"},[e[11]||(e[11]=t("option",{disabled:"",value:""},"Selecciona un g√©nero",-1)),(d(!0),u(V,null,I(x.genres,o=>(d(),u("option",{key:o.id,value:o.id},g(o.name),9,te))),128))],512),[[T,r(s).genre_id]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"text-gray-300 text-sm"},"Biograf√≠a",-1)),f(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=o=>r(s).bio=o),rows:"4",class:"input",placeholder:"Breve descripci√≥n del artista..."},null,512),[[_,r(s).bio]])]),A(J,{images:k.value,"file-inputs":y.value,onFileSelected:w,onDeleteImage:m},null,8,["images","file-inputs"]),t("div",null,[e[15]||(e[15]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Video de Presentaci√≥n ",-1)),e[16]||(e[16]=t("label",{class:"text-gray-300 text-sm"},"URL del Video (YouTube/Vimeo)",-1)),f(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>r(s).presentation_video_url=o),type:"url",class:"input",placeholder:"https://www.youtube.com/watch?v=... o https://vimeo.com/..."},null,512),[[_,r(s).presentation_video_url]]),e[17]||(e[17]=t("p",{class:"text-gray-500 text-xs mt-2"}," Soporta YouTube y Vimeo. Se mostrar√° en el perfil p√∫blico del artista. ",-1)),r(s).presentation_video_url?(d(),u("div",se,[e[14]||(e[14]=t("p",{class:"text-gray-300 text-sm mb-2"},"Vista previa:",-1)),t("div",le,[r(s).presentation_video_url.includes("youtube")?(d(),u("iframe",{key:0,src:`https://www.youtube.com/embed/${(i=r(s).presentation_video_url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&]+)/))==null?void 0:i[1]}`,class:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,ae)):r(s).presentation_video_url.includes("vimeo")?(d(),u("iframe",{key:1,src:`https://player.vimeo.com/video/${(n=r(s).presentation_video_url.match(/vimeo\.com\/(\d+)/))==null?void 0:n[1]}`,class:"w-full h-full",allow:"autoplay; fullscreen",allowfullscreen:""},null,8,oe)):(d(),u("p",re," URL no v√°lida. Usa YouTube o Vimeo. "))])])):b("",!0)]),t("div",null,[e[18]||(e[18]=t("h3",{class:"text-[#ffa236] font-semibold mb-2"}," Redes sociales / Streaming ",-1)),t("div",ie,[(d(),u(V,null,I({spotify:"Spotify",youtube:"YouTube",instagram:"Instagram",tiktok:"TikTok",facebook:"Facebook",x:"X / Twitter",apple:"Apple Music",amazon:"Amazon Music"},(o,v)=>t("div",{key:v},[t("label",ne,g(o),1),f(t("input",{"onUpdate:modelValue":$=>r(s).social_links[v]=$,type:"url",class:"input",placeholder:"https://..."},null,8,ue),[[_,r(s).social_links[v]]])])),64))]),e[19]||(e[19]=t("p",{class:"text-gray-500 text-xs mt-2"}," Solo se guardar√°n las redes con una URL v√°lida. ",-1))]),t("div",de,[t("button",ce,g(a.mode==="edit"?"Actualizar artista":"Guardar artista"),1)])],32)}}},_e=j(me,[["__scopeId","data-v-2e0d9362"]]);export{_e as default};
